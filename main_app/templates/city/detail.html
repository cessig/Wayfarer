{% extends "base.html" %}

{% block content %}
<div class="row">
<!-- SECTION Sidebar -->
  <div class="col-md-4">
    <!-- title -->
    <div class="row">
      <h1>Cities</h1>
    </div>
    <!-- city -->
    {% for city in cities %}
      <div class="row">
        <div class="media">
          <img class="mr-3" src="{{city.image_link}}" style="width:100px;" alt="city thumbnail">
          <div class="media-body">
            <a href="{% url 'city_detail' city.id%}"><button class="mt-0 bttn-slant bttn-lg bttn-warning bttn-no-outline">{{city.city_name}}</button></a>
          </div>
        </div>        
      </div>
    {% endfor %}

  </div>
<!-- SECTION Main content (Ciy description and User posts) -->
  <div class="col-md-7">
      <!-- City description-->   
      <div class="row">
        <div class="media">
          <script src="../../static/scripts/app.js"></script>
          <img class="mr-3" src="{{city.image_link}}"  alt="city thumbnail" style="width: 200px;">
          <div class="media-body">
            <h2 class="mt-0">{{city.city_name}}</h2>
          </div>
        </div>
      </div>
      <!-- User posts title -->
      <div class="row">
        <button type="button" class="bttn-pill bttn-sm bttn-warning float-right" data-toggle="modal" data-target="#AddNewCity">
          Add <i class="fa fa-plus-circle"></i>
        </button>
      </div>
      <!-- User posts -->
      <div class="row">
      
        <table class="striped">
          <thead>
            <tr><th>Reviews</th><th></th></tr>
          </thead>
          <tbody>
            {% for post in city.post_set.all %}
              <tr>
                <td><a href="/post/{{ post.id }}">{{post.title}}</a></td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      <div>
  </div>
</div>

<!-- Button trigger modal -->

{% if formInvalid %}
  <div class="alert alert-danger" role="alert">{{formInvalid}}</div>
{% endif %}


<!-- SECTION Modal-->
<div class="modal fade" id="AddNewCity" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add New Review</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
        <form action="{% url 'add_post' city.id %}" method="POST">
      <div class="modal-body">
        {% csrf_token %}
        {{post_form.as_p}}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <input type="submit" class="btn btn-primary" value="Add Post">
      </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
