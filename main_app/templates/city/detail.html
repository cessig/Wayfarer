{% extends "base.html" %}

{% block content %}
<div class="row city-body" style="padding: 50px;">
<!-- SECTION Sidebar -->
  <div class="col-md-4">
    <!-- title -->
    <div class="row">
      <h1 style="color: #416A4B;">Cities</h1>
    </div>
    <!-- city -->
    {% for city in cities %}
      <div class="row" style="margin: 15px 0px 15px 0px;">
        <div class="media">
          <img class="mr-3" src="{{city.image_link}}" style="width:150px; border-radius: 5px;" alt="city thumbnail">
          <div class="media-body city-name-buttons">
            <a href="{% url 'city_detail' city.id%}"><button class="mt-0 bttn-stretch bttn-lg bttn-default bttn-no-outline">{{city.city_name}}</button></a>
          </div>
        </div>        
      </div>
    {% endfor %}

  </div>
<!-- SECTION Main content (Ciy description and User posts) -->
  <div class="col-md-7">
      <!-- City description-->   
      <div class="row media-frame">
          <div class="media">
            <script src="../../static/scripts/app.js"></script>
            <img class="mr-3" src="{{city.image_link}}"  alt="city thumbnail" style="width: 200px;">
            <div class="media-body">
              <h2 class="mt-0">City: {{city.city_name}}</h2>
              Country: {{city.country_name}}
            </div>
          </div> 
      </div>
      <!-- User posts title and Icon -->
      <div class="row" style="background-color: #EDFFE9;">
        <div class="col">
        <button type="button" class="bttn-pill bttn-sm bttn-warning float-right" data-toggle="modal" data-target="#AddNewCity">
          Add <i class="fa fa-plus-circle"></i>
        </button>
        </div>
      </div>
      <!-- User posts -->
      <div class="row" style="background-color: #2C8C85;">
        <table class="striped">
          
            <tr><th>Posts</th><th></th></tr>
          </thead>
          <tbody>
            {% for post in city.post_set.all %}
              <tr>
                <td><a href="/post/{{ post.id }}">{{post.title}}</a></td>

              </tr>
            {% endfor %}
          </tbody>
        </table>
      <div>
  </div>
</div>

<!-- Button trigger modal -->

{% if formInvalid %}
  <div class="alert alert-danger" role="alert">{{formInvalid}}</div>
{% endif %}


<!-- SECTION Modal-->
<div class="modal fade" id="AddNewCity" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add New Review</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
        <form action="{% url 'add_post' city.id %}" method="POST">
      <div class="modal-body">
        {% csrf_token %}
        {{post_form.as_p}}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <input type="submit" class="btn btn-primary" value="Add Post">
      </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
